<!-- pages/product/product.wxml - äº§å“è¯¦æƒ… -->
<view class="page-product">
  <!-- äº§å“å›¾ç‰‡ -->
  <swiper class="product-gallery" indicator-dots wx:if="{{images.length > 0}}">
    <swiper-item wx:for="{{images}}" wx:key="index">
      <image class="gallery-image" src="{{item}}" mode="aspectFill" bindtap="previewImage" data-url="{{item}}" />
    </swiper-item>
  </swiper>

  <!-- ä»·æ ¼ä¿¡æ¯ -->
  <view class="price-section">
    <view class="price-row">
      <view class="price-main-wrap">
        <text class="price-symbol">Â¥</text>
        <text class="price-main">{{product.price}}</text>
      </view>
      <view class="member-price-tag" wx:if="{{memberDiscountLabel}}">
        <text class="member-label">{{memberDiscountLabel}}ä»·</text>
        <text class="member-price">Â¥{{memberPrice}}</text>
      </view>
      <text class="price-original" wx:if="{{product.original_price}}">Â¥{{product.original_price}}</text>
    </view>
  </view>

  <!-- äº§å“ä¿¡æ¯ -->
  <view class="info-section card">
    <view class="product-tags" wx:if="{{product.is_hot || product.is_new}}">
      <text class="tag tag-hot" wx:if="{{product.is_hot}}">çƒ­é—¨</text>
      <text class="tag tag-new" wx:if="{{product.is_new}}">æ–°å“</text>
    </view>
    <text class="product-name">{{product.name}}</text>
    <text class="product-desc" wx:if="{{product.description}}">{{product.description}}</text>
  </view>

  <!-- è§„æ ¼ä¿¡æ¯ -->
  <view class="specs-section card">
    <view class="spec-row" wx:if="{{product.specification}}">
      <text class="spec-label">è§„æ ¼</text>
      <text class="spec-value">{{product.specification}}</text>
    </view>
    <view class="spec-row" wx:if="{{product.origin}}">
      <text class="spec-label">äº§åœ°</text>
      <text class="spec-value">{{product.origin}}</text>
    </view>
    <view class="spec-row" wx:if="{{product.shelf_life}}">
      <text class="spec-label">ä¿è´¨æœŸ</text>
      <text class="spec-value">{{product.shelf_life}}å¤©</text>
    </view>
  </view>

  <!-- è¯¦æƒ…/è¯„ä»·æ ‡ç­¾ -->
  <view class="tabs-section card">
    <view class="tabs-header">
      <text class="tab-btn {{currentTab === 'detail' ? 'active' : ''}}" bindtap="switchTab" data-tab="detail">å•†å“è¯¦æƒ…</text>
      <text class="tab-btn {{currentTab === 'reviews' ? 'active' : ''}}" bindtap="switchTab" data-tab="reviews">ç”¨æˆ·è¯„ä»·</text>
    </view>

    <view class="tab-content" wx:if="{{currentTab === 'detail'}}">
      <text class="detail-text" wx:if="{{product.detail}}">{{product.detail}}</text>
      <text class="detail-text empty" wx:else>æš‚æ— è¯¦æƒ…</text>
    </view>

    <view class="tab-content" wx:if="{{currentTab === 'reviews'}}">
      <view class="review-item" wx:for="{{reviews}}" wx:key="id">
        <image class="review-avatar" src="{{item.avatar}}" />
        <view class="review-content">
          <text class="review-name">{{item.name}}</text>
          <text class="review-rating">{{item.rating}}</text>
          <text class="review-text">{{item.content}}</text>
        </view>
      </view>
      <view class="empty-reviews" wx:if="{{reviews.length === 0}}">
        <text>æš‚æ— è¯„ä»·</text>
      </view>
    </view>
  </view>

  <!-- åº•éƒ¨æ“ä½œæ  -->
  <view class="bottom-bar">
    <view class="bottom-left">
      <view class="bottom-btn" bindtap="goToHome">
        <text class="bottom-icon">ğŸ </text>
        <text class="bottom-text">é¦–é¡µ</text>
      </view>
      <view class="bottom-btn" bindtap="goToCart">
        <text class="bottom-icon">ğŸ›’</text>
        <text class="bottom-text">è´­ç‰©è½¦</text>
        <text class="cart-badge" wx:if="{{cartCount > 0}}">{{cartCount > 99 ? '99+' : cartCount}}</text>
      </view>
    </view>
    <view class="bottom-right">
      <button class="action-btn btn-cart" bindtap="addToCart">åŠ å…¥è´­ç‰©è½¦</button>
      <button class="action-btn btn-buy" bindtap="buyNow">ç«‹å³è´­ä¹°</button>
    </view>
  </view>
</view>
