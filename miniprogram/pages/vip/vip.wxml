<!-- pages/vip/vip.wxml - ä¼šå‘˜ä¸­å¿ƒï¼ˆé«˜ç«¯è®¾è®¡ï¼‰ -->
<view class="page-vip">
  <!-- é¡¶éƒ¨æ¸å˜èƒŒæ™¯ -->
  <view class="header-bg">
    <view class="header-pattern"></view>
  </view>

  <!-- ä¼šå‘˜å¡ç‰‡ -->
  <view class="member-card">
    <view class="card-inner">
      <!-- å½“å‰ä¼šå‘˜ä¿¡æ¯ -->
      <view class="member-info">
        <view class="avatar-wrap">
          <image class="avatar" src="{{userInfo.avatar || '/assets/default_avatar.png'}}" mode="aspectFill"></image>
          <view class="crown-icon" wx:if="{{isMemberValid}}">ğŸ‘‘</view>
        </view>
        <view class="info-content">
          <text class="nickname">{{userInfo.nickname || userInfo.phone || 'ä¼šå‘˜ç”¨æˆ·'}}</text>
          <view class="level-tag {{memberLevel}}">
            <text>{{memberLevelName}}</text>
          </view>
        </view>
      </view>

      <!-- ä¼šå‘˜æƒç›ŠçŠ¶æ€ -->
      <view class="member-status">
        <view class="status-item" wx:if="{{isMemberValid}}">
          <text class="status-label">æœ‰æ•ˆæœŸè‡³</text>
          <text class="status-value">{{expireDate}}</text>
        </view>
        <view class="status-item" wx:if="{{isMemberValid}}">
          <text class="status-label">ä¸“äº«æŠ˜æ‰£</text>
          <text class="status-value highlight">{{discountRate}}</text>
        </view>
        <view class="status-item full" wx:else>
          <text class="status-tip">å¼€é€šä¼šå‘˜ï¼Œäº«å—ä¸“å±æŠ˜æ‰£ä¼˜æƒ </text>
        </view>
      </view>
    </view>
  </view>

  <!-- ä¼šå‘˜æƒç›Šè¯´æ˜ -->
  <view class="benefits-section">
    <view class="section-title">
      <text class="title-icon">âœ¨</text>
      <text>ä¼šå‘˜ä¸“å±æƒç›Š</text>
    </view>
    <view class="benefits-grid">
      <view class="benefit-item">
        <view class="benefit-icon">ğŸ’°</view>
        <text class="benefit-name">å…¨åœºæŠ˜æ‰£</text>
        <text class="benefit-desc">è‡³é«˜85æŠ˜</text>
      </view>
    </view>
  </view>

  <!-- å¥—é¤é€‰æ‹© -->
  <view class="plans-section">
    <view class="section-title">
      <text class="title-icon">ğŸ«</text>
      <text>é€‰æ‹©ä¼šå‘˜å¥—é¤</text>
    </view>
    
    <!-- å¥—é¤å¡ç‰‡ -->
    <view class="plans-list">
      <view class="plan-card {{selectedPlanId === item.id ? 'selected' : ''}} {{item.level}}"
            wx:for="{{plans}}" wx:key="id"
            bindtap="selectPlan" data-id="{{item.id}}">
        <view class="plan-badge" wx:if="{{item.isHot}}">æ¨è</view>
        <view class="plan-header">
          <text class="plan-name">{{item.name}}</text>
          <text class="plan-level">{{item.level_display}}</text>
        </view>
        <view class="plan-price">
          <text class="price-symbol">Â¥</text>
          <text class="price-value">{{item.price}}</text>
          <text class="price-original" wx:if="{{item.original_price > item.price}}">Â¥{{item.original_price}}</text>
        </view>
        <view class="plan-info">
          <text class="plan-duration">{{item.duration_days}}å¤©æœ‰æ•ˆ</text>
          <text class="plan-discount">{{item.discount_display}}</text>
        </view>
        <view class="plan-check" wx:if="{{selectedPlanId === item.id}}">âœ“</view>
      </view>
    </view>
  </view>

  <!-- åº•éƒ¨è´­ä¹°æŒ‰é’® -->
  <view class="footer-action">
    <view class="price-summary">
      <text class="summary-label">åº”ä»˜ï¼š</text>
      <text class="summary-price">Â¥{{selectedPrice}}</text>
    </view>
    <button class="buy-btn {{!selectedPlanId ? 'disabled' : ''}}" bindtap="buyMembership">
      ç«‹å³å¼€é€š
    </button>
  </view>

  <!-- å®‰å…¨æç¤º -->
  <view class="safe-tips">
    <text>ğŸ”’ å®‰å…¨æ”¯ä»˜ Â· éšæ—¶ç»­è´¹ Â· å®¢æœä¿éšœ</text>
  </view>

  <!-- æ”¯ä»˜å¼¹çª— -->
  <pay-modal
    visible="{{showPayModal}}"
    orderId="{{currentOrderId}}"
    amount="{{selectedPrice}}"
    balance="{{userBalance}}"
    bind:success="onPaySuccess"
    bind:close="onPayClose"
  />
</view>
