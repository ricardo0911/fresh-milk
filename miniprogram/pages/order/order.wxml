<!-- pages/order/order.wxml - ç¡®è®¤è®¢å• -->
<view class="page-order">
  <!-- æ”¶è´§åœ°å€ -->
  <view class="address-section card" bindtap="selectAddress">
    <view wx:if="{{address}}">
      <view class="address-info">
        <text class="address-name">{{address.name}}</text>
        <text class="address-phone">{{address.phone}}</text>
      </view>
      <text class="address-detail">{{address.province}}{{address.city}}{{address.district}}{{address.address}}</text>
    </view>
    <view wx:else class="address-empty">
      <text class="address-icon">ğŸ“</text>
      <text class="address-text">è¯·é€‰æ‹©æ”¶è´§åœ°å€</text>
    </view>
    <text class="address-arrow">></text>
  </view>

  <!-- å•†å“åˆ—è¡¨ -->
  <view class="goods-section card">
    <view class="section-title">å•†å“ä¿¡æ¯</view>
    <view class="goods-item" wx:for="{{orderItems}}" wx:key="index">
      <image class="goods-image" src="{{item.product.cover_image}}" mode="aspectFill" />
      <view class="goods-info">
        <text class="goods-name">{{item.product.name}}</text>
        <text class="goods-spec">{{item.product.specification}}</text>
        <view class="goods-footer">
          <text class="price">{{item.product.price}}</text>
          <text class="goods-qty">Ã—{{item.quantity}}</text>
        </view>
      </view>
    </view>
  </view>

  <!-- ä¼˜æƒ åˆ¸ -->
  <view class="coupon-section card" bindtap="selectCoupon">
    <text class="coupon-label">ä¼˜æƒ åˆ¸</text>
    <view class="coupon-value" wx:if="{{selectedCoupon}}">
      <text class="coupon-name">{{selectedCoupon.name}}</text>
      <text class="coupon-discount">-Â¥{{selectedCoupon.discount}}</text>
    </view>
    <text class="coupon-value" wx:else>{{couponsCount > 0 ? couponsCount + 'å¼ å¯ç”¨' : 'æš‚æ— å¯ç”¨'}}</text>
    <text class="coupon-arrow">></text>
  </view>

  <!-- å¤‡æ³¨ -->
  <view class="remark-section card">
    <text class="remark-label">è®¢å•å¤‡æ³¨</text>
    <input class="remark-input" placeholder="é€‰å¡«ï¼šå¦‚æœ‰ç‰¹æ®Šéœ€æ±‚è¯·å¤‡æ³¨" bindinput="onRemarkInput" />
  </view>

  <!-- ä»·æ ¼æ˜ç»† -->
  <view class="price-section card">
    <view class="price-row">
      <text class="price-label">å•†å“é‡‘é¢</text>
      <text class="price-value">Â¥{{goodsAmount}}</text>
    </view>
    <view class="price-row">
      <text class="price-label">è¿è´¹</text>
      <text class="price-value">{{shipping > 0 ? 'Â¥' + shipping : 'å…è¿è´¹'}}</text>
    </view>
    <view class="price-row" wx:if="{{discountAmount > 0}}">
      <text class="price-label">ä¼˜æƒ </text>
      <text class="price-value discount">-Â¥{{discountAmount}}</text>
    </view>
  </view>

  <!-- åº•éƒ¨ç»“ç®— -->
  <view class="bottom-bar">
    <view class="total-section">
      <text class="total-label">åˆè®¡ï¼š</text>
      <text class="total-price price">{{totalAmount}}</text>
    </view>
    <button class="submit-btn" bindtap="submitOrder">æäº¤è®¢å•</button>
  </view>
</view>
