<!-- pages/address/address.wxml - æ”¶è´§åœ°å€ -->
<view class="page-address">
  <!-- åœ°å€åˆ—è¡¨ -->
  <view class="address-list" wx:if="{{addresses.length > 0}}">
    <view class="address-card {{item.is_default ? 'default' : ''}}" wx:for="{{addresses}}" wx:key="id">
      <view class="address-main" bindtap="selectAddress" data-address="{{item}}">
        <view class="address-header">
          <text class="address-name">{{item.name}}</text>
          <text class="address-phone">{{item.phone}}</text>
          <text class="default-tag" wx:if="{{item.is_default}}">é»˜è®¤</text>
        </view>
        <text class="address-detail">{{item.province}}{{item.city}}{{item.district}}{{item.address}}</text>
      </view>
      <view class="address-actions">
        <view class="action-item" catchtap="setDefault" data-id="{{item.id}}" wx:if="{{!item.is_default}}">
          <text class="action-icon">â­</text>
          <text>è®¾ä¸ºé»˜è®¤</text>
        </view>
        <view class="action-item" catchtap="editAddress" data-address="{{item}}">
          <text class="action-icon">âœï¸</text>
          <text>ç¼–è¾‘</text>
        </view>
        <view class="action-item" catchtap="deleteAddress" data-id="{{item.id}}">
          <text class="action-icon">ğŸ—‘ï¸</text>
          <text>åˆ é™¤</text>
        </view>
      </view>
    </view>
  </view>

  <!-- ç©ºçŠ¶æ€ -->
  <view class="empty-state" wx:else>
    <text class="empty-icon">ğŸ“</text>
    <text class="empty-text">æš‚æ— æ”¶è´§åœ°å€</text>
  </view>

  <!-- æ·»åŠ åœ°å€æŒ‰é’® -->
  <view class="add-btn-wrapper">
    <button class="add-btn" bindtap="showAddForm">+ æ·»åŠ æ–°åœ°å€</button>
  </view>

  <!-- æ·»åŠ /ç¼–è¾‘åœ°å€è¡¨å•å¼¹çª— -->
  <view class="modal-mask" wx:if="{{showForm}}" bindtap="hideForm"></view>
  <view class="modal-content" wx:if="{{showForm}}">
    <view class="modal-header">
      <text class="modal-title">{{editingAddress ? 'ç¼–è¾‘åœ°å€' : 'æ·»åŠ åœ°å€'}}</text>
      <text class="modal-close" bindtap="hideForm">Ã—</text>
    </view>
    
    <view class="form">
      <view class="form-item">
        <text class="form-label">æ”¶è´§äºº</text>
        <input class="form-input" placeholder="è¯·è¾“å…¥æ”¶è´§äººå§“å" value="{{form.name}}" bindinput="onInput" data-field="name" />
      </view>
      
      <view class="form-item">
        <text class="form-label">æ‰‹æœºå·</text>
        <input class="form-input" type="number" placeholder="è¯·è¾“å…¥æ‰‹æœºå·" value="{{form.phone}}" bindinput="onInput" data-field="phone" maxlength="11" />
      </view>
      
      <view class="form-item">
        <text class="form-label">æ‰€åœ¨åœ°åŒº</text>
        <picker mode="region" value="{{region}}" bindchange="onRegionChange">
          <view class="region-picker">
            <text wx:if="{{region.length > 0}}">{{region[0]}} {{region[1]}} {{region[2]}}</text>
            <text wx:else class="placeholder">è¯·é€‰æ‹©çœå¸‚åŒº</text>
            <text class="picker-arrow">></text>
          </view>
        </picker>
      </view>
      
      <view class="form-item">
        <text class="form-label">è¯¦ç»†åœ°å€</text>
        <textarea class="form-textarea" placeholder="è¯·è¾“å…¥è¯¦ç»†åœ°å€ï¼ˆè¡—é“ã€é—¨ç‰Œå·ç­‰ï¼‰" value="{{form.address}}" bindinput="onInput" data-field="address" />
      </view>
      
      <view class="form-item switch-item">
        <text class="form-label">è®¾ä¸ºé»˜è®¤åœ°å€</text>
        <switch checked="{{form.is_default}}" bindchange="onDefaultChange" color="#10b981" />
      </view>
    </view>

    <view class="modal-footer">
      <button class="btn btn-primary btn-block" bindtap="saveAddress">ä¿å­˜</button>
    </view>
  </view>
</view>
