<!-- pages/cart/cart.wxml - è´­ç‰©è½¦ -->
<view class="page-cart">
  <view wx:if="{{cartItems.length > 0}}">
    <!-- è´­ç‰©è½¦åˆ—è¡¨ -->
    <view class="cart-list">
      <view class="cart-item" wx:for="{{cartItems}}" wx:key="index">
        <checkbox class="cart-checkbox" checked="{{item.selected}}" bindtap="toggleSelect" data-index="{{index}}" />
        <image class="cart-image" src="{{item.product.cover_image}}" mode="aspectFill" bindtap="goToProduct" data-id="{{item.product.id}}" />
        <view class="cart-info">
          <text class="cart-name">{{item.product.name}}</text>
          <text class="cart-spec">{{item.product.specification}}</text>
          <view class="cart-footer">
            <text class="price">{{item.product.price}}</text>
            <view class="quantity-selector">
              <text class="qty-btn" bindtap="decreaseQty" data-index="{{index}}">âˆ’</text>
              <text class="qty-value">{{item.quantity}}</text>
              <text class="qty-btn" bindtap="increaseQty" data-index="{{index}}">+</text>
            </view>
          </view>
        </view>
        <text class="cart-delete" bindtap="removeItem" data-index="{{index}}">Ã—</text>
      </view>
    </view>

    <!-- åº•éƒ¨ç»“ç®—æ  -->
    <view class="cart-bottom">
      <view class="select-all" bindtap="toggleSelectAll">
        <checkbox checked="{{allSelected}}" />
        <text>å…¨é€‰</text>
      </view>
      <view class="cart-summary">
        <text class="summary-text">åˆè®¡: </text>
        <text class="summary-price price">{{totalAmount}}</text>
      </view>
      <button class="checkout-btn {{selectedCount === 0 ? 'disabled' : ''}}" bindtap="checkout" disabled="{{selectedCount === 0}}">
        å»ç»“ç®— ({{selectedCount}})
      </button>
    </view>
  </view>

  <!-- ç©ºè´­ç‰©è½¦ -->
  <view class="empty-state" wx:else>
    <text class="empty-icon">ğŸ›’</text>
    <text class="empty-text">è´­ç‰©è½¦è¿˜æ˜¯ç©ºçš„</text>
    <button class="btn btn-primary" bindtap="goShopping">å»é€›é€›</button>
  </view>

  <!-- çŒœä½ å–œæ¬¢ -->
  <view class="section guess-section">
    <view class="section-header">
      <view class="guess-title-wrap">
        <text class="guess-icon">ğŸ’™</text>
        <text class="section-title">çŒœä½ å–œæ¬¢</text>
      </view>
      <text class="section-more" bindtap="goToProducts">æ¢ä¸€æ‰¹</text>
    </view>
    <view class="guess-grid">
      <view class="guess-card" wx:for="{{guessProducts}}" wx:key="id" bindtap="goToProduct" data-id="{{item.id}}">
        <view class="guess-image-wrap">
          <image class="guess-image" src="{{item.cover_image}}" mode="aspectFill" />
          <view class="guess-fresh-tag" wx:if="{{item.fresh_days}}">
            <text class="fresh-days">{{item.fresh_days}}å¤©èµ·</text>
            <text class="fresh-label">æ–°é²œæ—¥æœŸ</text>
          </view>
        </view>
        <view class="guess-info">
          <text class="guess-name">{{item.name}}</text>
          <text class="guess-spec">{{item.specification}}</text>
          <view class="guess-footer">
            <text class="guess-price">Â¥{{item.price}}</text>
            <view class="guess-actions">
              <view class="action-btn-text" catchtap="addToCart" data-product="{{item}}">ç«‹å³è´­ä¹°</view>
            </view>
          </view>
        </view>
      </view>
    </view>
  </view>
</view>
