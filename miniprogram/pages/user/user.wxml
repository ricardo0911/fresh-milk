<!-- pages/user/user.wxml - 个人中心（高端定制版） -->
<view class="page-container">
  <!-- 沉浸式顶部背景 -->
  <view class="premium-bg">
    <image class="bg-pattern" src="" mode="aspectFill"></image>
  </view>

  <!-- 顶部导航区域 (占位，保持胶囊对齐) -->
  <view class="nav-bar-placeholder"></view>

  <!-- 用户身份卡片 (悬浮设计) -->
  <view class="user-card-wrap">
    <view class="user-card" bindtap="{{userInfo ? 'goToProfile' : 'goToLogin'}}">
      <!-- 金色纹理背景 -->
      <view class="card-texture"></view>
      
      <!-- 用户信息行 -->
      <view class="user-info-row">
        <view class="avatar-container">
          <image class="avatar" src="{{userInfo.avatar || 'https://mmbiz.qpic.cn/mmbiz/icTdbqWNOwNRna42FI242Lcia07jQodd2FJGIYQfG0LAJGFxM4FbnQP6yfMxBgJ0F3YRqJCJ1aPAK2dQagdusBZg/0'}}" mode="aspectFill"></image>
          <view class="vip-crown" wx:if="{{userInfo}}">👑</view>
        </view>
        <view class="info-content">
          <view class="name-box">
            <text class="nickname">{{userInfo.username || userInfo.phone || '点击登录/注册'}}</text>
            <view class="member-tag {{memberLevel}}" wx:if="{{userInfo}}">
              <text class="tag-text">{{memberLevelName}}</text>
            </view>
          </view>
          <text class="subtitle" wx:if="{{userInfo}}">尊享全场{{discountRate}}优惠</text>
          <text class="subtitle" wx:else>登录开启尊享鲜奶之旅</text>
        </view>
        <view class="arrow-icon">
          <text class="icon-text">></text>
        </view>
      </view>

      <!-- 会员权益数据 (金刚区) -->
      <view class="member-stats">
        <view class="stat-item">
          <text class="stat-num">{{points || 0}}</text>
          <text class="stat-lbl">积分</text>
        </view>
        <view class="stat-divider"></view>
        <view class="stat-item">
          <text class="stat-num">{{couponCount || 0}}</text>
          <text class="stat-lbl">优惠券</text>
        </view>
        <view class="stat-divider"></view>
        <view class="stat-item">
          <text class="stat-num">{{balance || '0.00'}}</text>
          <text class="stat-lbl">余额</text>
        </view>
      </view>
    </view>
  </view>

  <!-- 内容区域 -->
  <view class="content-body">
    
    <!-- 订单服务 -->
    <view class="section-card">
      <view class="card-header" bindtap="goToOrders">
        <text class="header-title">我的订单</text>
        <view class="header-more">
          <text>全部订单</text>
          <text class="arrow">></text>
        </view>
      </view>
      <view class="order-grid">
        <view class="grid-item" bindtap="goToOrders" data-status="pending">
          <view class="icon-box">
            <text class="grid-icon">💳</text>
            <view class="badge" wx:if="{{pendingCount > 0}}">{{pendingCount}}</view>
          </view>
          <text class="grid-text">待付款</text>
        </view>
        <view class="grid-item" bindtap="goToOrders" data-status="paid">
          <view class="icon-box">
            <text class="grid-icon">📦</text>
            <view class="badge" wx:if="{{paidCount > 0}}">{{paidCount}}</view>
          </view>
          <text class="grid-text">待发货</text>
        </view>
        <view class="grid-item" bindtap="goToOrders" data-status="shipped">
          <view class="icon-box">
            <text class="grid-icon">🚚</text>
            <view class="badge" wx:if="{{shippedCount > 0}}">{{shippedCount}}</view>
          </view>
          <text class="grid-text">待收货</text>
        </view>
        <view class="grid-item" bindtap="goToOrders" data-status="completed">
          <view class="icon-box">
            <text class="grid-icon">📝</text>
          </view>
          <text class="grid-text">待评价</text>
        </view>
        <view class="grid-item" bindtap="goToRefund">
          <view class="icon-box">
            <text class="grid-icon">🎧</text>
          </view>
          <text class="grid-text">售后/退款</text>
        </view>
      </view>
    </view>

    <!-- 常用功能 (广告位/入口) -->
    <view class="banner-card" bindtap="goToSubscription">
       <view class="banner-info">
         <text class="banner-title">周期购服务</text>
         <text class="banner-desc">鲜奶定期送到家，省心更优惠</text>
       </view>
       <view class="banner-btn">立即管理</view>
    </view>

    <!-- 更多服务 -->
    <view class="section-card">
      <view class="card-header">
        <text class="header-title">尊享服务</text>
      </view>
      <view class="service-list">
        <view class="service-item" bindtap="goToAddress">
          <view class="service-left">
            <text class="service-icon">📍</text>
            <text class="service-name">地址管理</text>
          </view>
          <text class="service-arrow">></text>
        </view>
        <view class="service-item" bindtap="goToFavorites">
          <view class="service-left">
            <text class="service-icon">❤️</text>
            <text class="service-name">我的收藏</text>
          </view>
          <text class="service-arrow">></text>
        </view>
        <view class="service-item" bindtap="goToFeedback">
          <view class="service-left">
            <text class="service-icon">💭</text>
            <text class="service-name">意见反馈</text>
          </view>
          <text class="service-arrow">></text>
        </view>
        <view class="service-item" bindtap="callService">
          <view class="service-left">
            <text class="service-icon">📞</text>
            <text class="service-name">联系客服</text>
          </view>
          <text class="service-value">400-888-8888</text>
        </view>
        <view class="service-item" bindtap="goToSettings">
          <view class="service-left">
            <text class="service-icon">⚙️</text>
            <text class="service-name">设置</text>
          </view>
          <text class="service-arrow">></text>
        </view>
      </view>
    </view>
    
    <!-- 退出登录 -->
    <view class="logout-area" wx:if="{{userInfo}}">
      <view class="logout-text" bindtap="logout">退出登录</view>
    </view>

    <view class="footer-spacing"></view>
  </view>
</view>
