<!-- pages/user/user.wxml - ä¸ªäººä¸­å¿ƒï¼ˆé«˜ç«¯å®šåˆ¶ç‰ˆï¼‰ -->
<view class="page-container">
  <!-- æ²‰æµ¸å¼é¡¶éƒ¨èƒŒæ™¯ -->
  <view class="premium-bg">
    <image class="bg-pattern" src="" mode="aspectFill"></image>
  </view>

  <!-- é¡¶éƒ¨å¯¼èˆªåŒºåŸŸ (å ä½ï¼Œä¿æŒèƒ¶å›Šå¯¹é½) -->
  <view class="nav-bar-placeholder"></view>

  <!-- ç”¨æˆ·èº«ä»½å¡ç‰‡ (æ‚¬æµ®è®¾è®¡) -->
  <view class="user-card-wrap">
    <view class="user-card" bindtap="{{userInfo ? 'goToProfile' : 'goToLogin'}}">
      <!-- é‡‘è‰²çº¹ç†èƒŒæ™¯ -->
      <view class="card-texture"></view>
      
      <!-- ç”¨æˆ·ä¿¡æ¯è¡Œ -->
      <view class="user-info-row">
        <view class="avatar-container">
          <image class="avatar" src="{{userInfo.avatar || 'https://mmbiz.qpic.cn/mmbiz/icTdbqWNOwNRna42FI242Lcia07jQodd2FJGIYQfG0LAJGFxM4FbnQP6yfMxBgJ0F3YRqJCJ1aPAK2dQagdusBZg/0'}}" mode="aspectFill"></image>
          <view class="vip-crown" wx:if="{{isMemberValid}}">ğŸ‘‘</view>
        </view>
        <view class="info-content">
          <view class="name-box">
            <text class="nickname">{{userInfo.nickname || userInfo.username || userInfo.phone || 'ç‚¹å‡»ç™»å½•/æ³¨å†Œ'}}</text>
            <view class="member-tag {{memberLevel}}" wx:if="{{userInfo}}">
              <text class="tag-text">{{memberLevelName}}</text>
            </view>
          </view>
          <text class="subtitle" wx:if="{{userInfo.id || userInfo.phone || userInfo.username || userInfo.nickname}}">æ¬¢è¿æ¥åˆ°é²œå¥¶ç›´è¾¾</text>
          <text class="subtitle" wx:else>ç™»å½•å¼€å¯å°Šäº«é²œå¥¶ä¹‹æ—…</text>
        </view>
        <view class="arrow-icon">
          <text class="icon-text">></text>
        </view>
      </view>

      <!-- ä¼šå‘˜æƒç›Šæ•°æ® (é‡‘åˆšåŒº) -->
      <view class="member-stats">
        <view class="stat-item" bindtap="goToPoints">
          <text class="stat-num">{{points || 0}}</text>
          <text class="stat-lbl">ç§¯åˆ†</text>
        </view>
        <view class="stat-divider"></view>
        <view class="stat-item" bindtap="goToCoupon">
          <text class="stat-num">{{couponCount || 0}}</text>
          <text class="stat-lbl">ä¼˜æƒ åˆ¸</text>
        </view>

      </view>
    </view>
  </view>

  <!-- å†…å®¹åŒºåŸŸ -->
  <view class="content-body">
    
    <!-- è®¢å•æœåŠ¡ -->
    <view class="section-card">
      <view class="card-header" bindtap="goToOrders">
        <text class="header-title">æˆ‘çš„è®¢å•</text>
        <view class="header-more">
          <text>å…¨éƒ¨è®¢å•</text>
          <text class="arrow">></text>
        </view>
      </view>
      <view class="order-grid">
        <view class="grid-item" bindtap="goToOrders" data-status="pending">
          <view class="icon-box">
            <text class="grid-icon">ğŸ’³</text>
            <!-- <view class="badge" wx:if="{{pendingCount > 0}}">{{pendingCount}}</view> -->
          </view>
          <text class="grid-text">å¾…ä»˜æ¬¾</text>
        </view>
        <view class="grid-item" bindtap="goToOrders" data-status="paid">
          <view class="icon-box">
            <text class="grid-icon">ğŸ“¦</text>
            <!-- <view class="badge" wx:if="{{paidCount > 0}}">{{paidCount}}</view> -->
          </view>
          <text class="grid-text">å¾…å‘è´§</text>
        </view>
        <view class="grid-item" bindtap="goToOrders" data-status="shipped">
          <view class="icon-box">
            <text class="grid-icon">ğŸšš</text>
            <!-- <view class="badge" wx:if="{{shippedCount > 0}}">{{shippedCount}}</view> -->
          </view>
          <text class="grid-text">å¾…æ”¶è´§</text>
        </view>
        <view class="grid-item" bindtap="goToOrders" data-status="completed">
          <view class="icon-box">
            <text class="grid-icon">ğŸ“</text>
          </view>
          <text class="grid-text">å¾…è¯„ä»·</text>
        </view>
        <view class="grid-item" bindtap="goToRefund">
          <view class="icon-box">
            <text class="grid-icon">ğŸ§</text>
          </view>
          <text class="grid-text">å”®å/é€€æ¬¾</text>
        </view>
      </view>
    </view>

    <!-- ä¼šå‘˜å…¥å£å¡ç‰‡ -->
    <view class="vip-card" wx:if="{{userInfo}}" bindtap="goToVip">
      <view class="vip-left">
        <view class="vip-icon">ğŸ‘‘</view>
        <view class="vip-info">
          <text class="vip-title">{{isMemberValid ? memberLevelName : 'å¼€é€šä¼šå‘˜'}}</text>
          <text class="vip-desc">{{isMemberValid ? 'æœ‰æ•ˆæœŸè‡³' + memberExpireDate : 'äº«ä¸“å±æŠ˜æ‰£ï¼Œæœ€é«˜85æŠ˜'}}</text>
        </view>
      </view>
      <view class="vip-btn">{{isMemberValid ? 'ç»­è´¹' : 'ç«‹å³å¼€é€š'}}</view>
    </view>

    <!-- å¸¸ç”¨åŠŸèƒ½ (å¹¿å‘Šä½/å…¥å£) -->
    <view class="banner-card" bindtap="goToSubscription">
       <view class="banner-info">
         <text class="banner-title">å‘¨æœŸè´­æœåŠ¡</text>
         <text class="banner-desc">é²œå¥¶å®šæœŸé€åˆ°å®¶ï¼Œçœå¿ƒæ›´ä¼˜æƒ </text>
       </view>
       <view class="banner-btn">ç«‹å³ç®¡ç†</view>
    </view>

    <!-- æ›´å¤šæœåŠ¡ -->
    <view class="section-card">
      <view class="card-header">
        <text class="header-title">å°Šäº«æœåŠ¡</text>
      </view>
      <view class="service-list">
        <view class="service-item" bindtap="goToAddress">
          <view class="service-left">
            <text class="service-icon">ğŸ“</text>
            <text class="service-name">åœ°å€ç®¡ç†</text>
          </view>
          <text class="service-arrow">></text>
        </view>
        <view class="service-item" bindtap="goToMyReviews">
          <view class="service-left">
            <text class="service-icon">â­</text>
            <text class="service-name">æˆ‘çš„è¯„ä»·</text>
          </view>
          <text class="service-arrow">></text>
        </view>
        <view class="service-item" bindtap="goToFeedback">
          <view class="service-left">
            <text class="service-icon">ğŸ’­</text>
            <text class="service-name">æ„è§åé¦ˆ</text>
          </view>
          <text class="service-arrow">></text>
        </view>
        <view class="service-item" bindtap="callService">
          <view class="service-left">
            <text class="service-icon">ğŸ“</text>
            <text class="service-name">è”ç³»å®¢æœ</text>
          </view>
          <text class="service-value">400-888-8888</text>
        </view>
        <view class="service-item" bindtap="goToSettings">
          <view class="service-left">
            <text class="service-icon">âš™ï¸</text>
            <text class="service-name">è®¾ç½®</text>
          </view>
          <text class="service-arrow">></text>
        </view>
      </view>
    </view>
    
    <!-- é€€å‡ºç™»å½• -->
    <view class="logout-area" wx:if="{{userInfo}}">
      <view class="logout-text" bindtap="logout">é€€å‡ºç™»å½•</view>
    </view>

    <view class="footer-spacing"></view>
  </view>
</view>
