<!-- pages/orders/orders.wxml - è®¢å•åˆ—è¡¨ -->
<view class="page-orders">
  <!-- è®¢å•çŠ¶æ€æ ‡ç­¾ -->
  <scroll-view class="tabs-scroll" scroll-x>
    <view class="tabs">
      <view class="tab {{currentStatus === '' ? 'active' : ''}}" bindtap="switchStatus" data-status="">å…¨éƒ¨</view>
      <view class="tab {{currentStatus === 'pending' ? 'active' : ''}}" bindtap="switchStatus" data-status="pending">å¾…ä»˜æ¬¾</view>
      <view class="tab {{currentStatus === 'paid' ? 'active' : ''}}" bindtap="switchStatus" data-status="paid">å¾…å‘è´§</view>
      <view class="tab {{currentStatus === 'shipped' ? 'active' : ''}}" bindtap="switchStatus" data-status="shipped">å¾…æ”¶è´§</view>
      <view class="tab {{currentStatus === 'completed' ? 'active' : ''}}" bindtap="switchStatus" data-status="completed">å·²å®Œæˆ</view>
    </view>
  </scroll-view>

  <!-- è®¢å•åˆ—è¡¨ -->
  <view class="order-list">
    <view class="order-card" wx:for="{{orders}}" wx:key="id" bindtap="goToOrderDetail" data-id="{{item.id}}">
      <view class="order-header">
        <text class="order-no">è®¢å•å·: {{item.order_no}}</text>
        <text class="order-status status-{{item.status}}">{{item.status_display}}</text>
      </view>

      <view class="order-items">
        <view class="order-item" wx:for="{{item.items}}" wx:for-item="product" wx:key="id">
          <image class="item-image" src="{{product.cover_image}}" mode="aspectFill" />
          <view class="item-info">
            <text class="item-name">{{product.name}}</text>
            <text class="item-spec">{{product.specification}}</text>
            <view class="item-bottom">
              <text class="item-price">Â¥{{product.price}}</text>
              <text class="item-qty">x{{product.quantity}}</text>
            </view>
          </view>
        </view>
      </view>

      <view class="order-footer">
        <view class="order-total">
          <text>å…±{{item.total_count}}ä»¶ï¼Œåˆè®¡ï¼š</text>
          <text class="total-price">Â¥{{item.total_amount}}</text>
        </view>
        <view class="order-actions">
          <view class="action-btn btn-default" wx:if="{{item.status === 'pending'}}" catchtap="cancelOrder" data-id="{{item.id}}">å–æ¶ˆè®¢å•</view>
          <view class="action-btn btn-primary" wx:if="{{item.status === 'pending'}}" catchtap="payOrder" data-id="{{item.id}}">å»æ”¯ä»˜</view>
          <view class="action-btn btn-primary" wx:if="{{item.status === 'shipped'}}" catchtap="confirmReceive" data-id="{{item.id}}">ç¡®è®¤æ”¶è´§</view>
          <view class="action-btn btn-default" wx:if="{{item.status === 'completed'}}" catchtap="buyAgain" data-order="{{item}}">å†æ¬¡è´­ä¹°</view>
          <view class="action-btn btn-primary" wx:if="{{item.status === 'completed' && !item.is_reviewed}}" catchtap="goToReview" data-id="{{item.id}}">å»è¯„ä»·</view>
        </view>
      </view>
    </view>

    <!-- ç©ºçŠ¶æ€ -->
    <view class="empty-state" wx:if="{{orders.length === 0}}">
      <text class="empty-icon">ğŸ“¦</text>
      <text class="empty-text">æš‚æ— è®¢å•</text>
      <button class="btn btn-primary" bindtap="goShopping">å»é€›é€›</button>
    </view>
  </view>
</view>
